/*!
 * vue-test v1.0.0
 * (c) 2017-2017 wyq
 * Released under the ISC License.
 * 
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.Vues=e()}(this,function(){"use strict";function t(t){if(t&&"object"===(void 0===t?"undefined":e(t)))return console.log(t),new u(t)}var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n=(function(){function t(t){this.value=t}function e(e){function n(o,r){try{var u=e[o](r),a=u.value;a instanceof t?Promise.resolve(a.value).then(function(t){n("next",t)},function(t){n("throw",t)}):i(u.done?"return":"normal",u.value)}catch(t){i("throw",t)}}function i(t,e){switch(t){case"return":o.resolve({value:e,done:!0});break;case"throw":o.reject(e);break;default:o.resolve({value:e,done:!1})}(o=o.next)?n(o.key,o.arg):r=null}var o,r;this._invoke=function(t,e){return new Promise(function(i,u){var a={key:t,arg:e,resolve:i,reject:u,next:null};r?r=r.next=a:(o=r=a,n(t,e))})},"function"!=typeof e.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(e.prototype[Symbol.asyncIterator]=function(){return this}),e.prototype.next=function(t){return this._invoke("next",t)},e.prototype.throw=function(t){return this._invoke("throw",t)},e.prototype.return=function(t){return this._invoke("return",t)}}(),function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}),i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=0,r=function(){function t(){n(this,t),this.id=o++,this.subs=[]}return i(t,[{key:"notify",value:function(){this.subs.forEach(function(t){t.update()})}},{key:"addSub",value:function(t){this.subs.push(t)}},{key:"depend",value:function(){console.log("depend"),t.target.addDep(this)}}]),t}();r.target=null;var u=function(){function e(t){n(this,e),this.data=t,this.walk(t)}return i(e,[{key:"walk",value:function(t){var e=this;Object.keys(t).forEach(function(n){e.defineReactive(e.data,n,t[n])})}},{key:"convert",value:function(t,e){this.defineReactive(this.data,t,e)}},{key:"defineReactive",value:function(e,n,i){console.log("defineReactive",e,n,i);var o=new r,u=t(i);Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:function(){return r.target&&o.depend(),i},set:function(e){e!==i&&(console.log(e),i=e,u=t(e),o.notify())}})}}]),e}(),a=function(){function t(e,i,o){n(this,t),this.vm=e,this.expOrFn=i,this.cb=o,this.depIds={},this.getter="function"==typeof i?i:this.parseGetter(i),this.value=this.get()}return i(t,[{key:"get",value:function(){r.target=this;var t=this.getter.call(this.vm,this.vm);return r.target=null,t}},{key:"addDep",value:function(t){this.depIds.hasOwnProperty(t.id)||(t.addSub(this),this.depIds[t.id]=t)}},{key:"update",value:function(){this.run()}},{key:"run",value:function(){var t=this.get(),e=this.value;t!=e&&(this.value=t,this.cb.call(this.vm,t,e))}},{key:"parseGetter",value:function(t){if(!/[^\w.$]/.test(t)){var e=t.split(".");return function(t){return e.forEach(function(e){t&&(t=t[e])}),t}}}}]),t}(),c={modelUpdater:function(t,e,n){t.value=void 0===e?"":e},textUpdater:function(t,e){t.textContent=void 0===e?"":e},htmlUpdater:function(t,e){t.innerHTML=void 0===e?"":e},classUpdater:function(t,e,n){var i=t.className,o=(i=i.replace(n,"").replace(/\s$/,""))&&String(e)?" ":"";t.className=i+o+e}},s={text:function(t,e,n){this.bind(t,e,n,"text")},html:function(t,e,n){this.bind(t,e,n,"html")},model:function(t,e,n){this.bind(t,e,n,"model");var i=this,o=this._getVMVal(e,n);t.addEventListener("input",function(t){var r=t.target.value;o!==r&&(i._setVMVal(e,n,r),o=r)})},bind:function(t,e,n,i){var o=c[i+"Updater"];o&&o(t,this._getVMVal(e,n)),new a(e,n,function(e,n){o&&o(t,e,n)})},eventHandler:function(t,e,n,i){var o=i.split(":")[1],r=e.$options.methods&&e.$options.methods[n];o&&r&&t.addEventListener(o,r.bind(e),!1)},_getVMVal:function(t,e){var n=t;return(e=e.split(".")).forEach(function(t){n=n[t]}),n},_setVMVal:function(t,e,n){var i=t;(e=e.split(".")).forEach(function(t,o){o<e.length-1?i=i[t]:i[t]=n})}},l=function(){function t(e,i){n(this,t),this.$vm=i,this.$el=this.isElementNode(e)?e:document.querySelector(e),this.$el&&(this.$fragment=this.node2Fragment(this.$el),this.init(),this.$el.appendChild(this.$fragment))}return i(t,[{key:"node2Fragment",value:function(t){for(var e,n=document.createDocumentFragment();e=t.firstChild;)n.appendChild(e);return n}},{key:"init",value:function(){this.compileElement(this.$fragment)}},{key:"compileElement",value:function(t){var e=t.childNodes,n=this;[].slice.call(e).forEach(function(t){var e=t.textContent;console.log("textContent:",t,e,n.isElementNode(t));n.isElementNode(t)?n.compile(t):n.isTextNode(t)&&/\{\{(.*)\}\}/.test(e)&&n.compileText(t,RegExp.$1),t.childNodes&&t.childNodes.length&&n.compileElement(t)})}},{key:"compile",value:function(t){var e=t.attributes,n=this;[].slice.call(e).forEach(function(e){var i=e.name;if(n.isDirective(i)){var o=e.value,r=i.substring(2);n.isEventDirective(r)?s.eventHandler(t,n.$vm,o,r):s[r]&&s[r](t,n.$vm,o)}})}},{key:"compileText",value:function(t,e){s.text(t,this.$vm,e)}},{key:"isDirective",value:function(t){return 0==t.indexOf("v-")}},{key:"isEventDirective",value:function(t){return 0===t.indexOf("on")}},{key:"isTextNode",value:function(t){return 3==t.nodeType}},{key:"isElementNode",value:function(t){return 1==t.nodeType}}]),t}(),f=function(){function e(i){var o=this;n(this,e),this.$options=i;var r=this.$data=i.data;Object.keys(r).forEach(function(t){o._proxy(t)}),t(r?r:this.$data={}),this.$compile=new l(this.$options.el||document.body,this)}return i(e,[{key:"_proxy",value:function(t){var e=this;Object.defineProperty(e,t,{enumerable:!0,configurable:!1,get:function(){return e.$data[t]},set:function(n){e.$data[t]=n}})}}]),e}();return f.version="0.0.1",f});